{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///F:/school/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || 'https://placeholder.supabase.co';\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || 'placeholder';\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\r\n\r\nexport type Student = {\r\n  id: string;\r\n  full_name: string;\r\n  national_id: string;\r\n  grade: string;\r\n  section: string;\r\n  dob: string;\r\n  phone: string;\r\n  address: string;\r\n  status: 'منتظم' | 'منقطع' | 'محول';\r\n  image_url?: string;\r\n  created_at?: string;\r\n};\r\n\r\nexport type Log = {\r\n  id: string;\r\n  action: string;\r\n  details: any;\r\n  user_id: string;\r\n  created_at: string;\r\n};\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,gFAAwC;AAC5D,MAAM,kBAAkB,wPAA6C;AAE9D,MAAM,WAAW,IAAA,8LAAY,EAAC,aAAa"}},
    {"offset": {"line": 41, "column": 0}, "map": {"version":3,"sources":["file:///F:/school/app/dashboard/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { UserCheck, TrendingUp, Calendar, GraduationCap } from 'lucide-react';\r\nimport { motion } from 'framer-motion';\r\nimport { supabase } from '@/lib/supabase';\r\nimport { useRouter } from 'next/navigation';\r\n\r\nexport default function DashboardPage() {\r\n    const router = useRouter();\r\n    const [stats, setStats] = useState({\r\n        students_count: 0,\r\n        attendance_today: 0,\r\n        attendance_percentage: 0\r\n    });\r\n    const [recentLogs, setRecentLogs] = useState<any[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        fetchDashboardData();\r\n    }, []);\r\n\r\n    const fetchDashboardData = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const today = new Date().toISOString().split('T')[0];\r\n\r\n            // Parallel Fetching\r\n            const [students, logs, attendance] = await Promise.all([\r\n                supabase.from('students').select('*', { count: 'exact', head: true }),\r\n                supabase.from('logs').select('*').order('created_at', { ascending: false }).limit(5),\r\n                supabase.from('attendance').select('*').eq('date', today)\r\n            ]);\r\n\r\n            // حساب الحضور\r\n            const totalStudents = students.count || 0;\r\n            const attendanceToday = attendance.data?.filter((a: any) => a.status === 'present').length || 0;\r\n            const attendancePercentage = totalStudents > 0 ? Math.round((attendanceToday / totalStudents) * 100) : 0;\r\n\r\n            setStats({\r\n                students_count: totalStudents,\r\n                attendance_today: attendanceToday,\r\n                attendance_percentage: attendancePercentage\r\n            });\r\n\r\n            setRecentLogs(logs.data || []);\r\n        } catch (error) {\r\n            console.error('Error fetching dashboard data:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const cards = [\r\n        {\r\n            title: 'إجمالي الطلاب',\r\n            value: stats.students_count,\r\n            icon: GraduationCap,\r\n            trend: '+12 هذا الأسبوع',\r\n            color: 'text-blue-600',\r\n            bg: 'bg-blue-50'\r\n        },\r\n        {\r\n            title: 'الحضور اليوم',\r\n            value: `${stats.attendance_today}/${stats.students_count}`,\r\n            subtitle: `${stats.attendance_percentage}%`,\r\n            icon: UserCheck,\r\n            trend: `معدل الحضور ${stats.attendance_percentage}%`,\r\n            color: 'text-emerald-600',\r\n            bg: 'bg-emerald-50'\r\n        }\r\n    ];\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex-center\" style={{ height: '50vh' }}>\r\n                <div style={{ width: '40px', height: '40px', border: '3px solid #e2e8f0', borderTopColor: '#0f172a', borderRadius: '50%', animation: 'spin 1s linear infinite' }} />\r\n                <style jsx>{`@keyframes spin { 100% { transform: rotate(360deg); } }`}</style>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div style={{ maxWidth: '1400px', margin: '0 auto' }}>\r\n            <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '2rem' }}>\r\n                <div>\r\n                    <h1 style={{ fontSize: '1.5rem', fontWeight: 'bold' }}>نظرة عامة</h1>\r\n                    <p style={{ color: 'var(--text-muted)' }}>مرحباً بك في لوحة تحكم المدرسة الرقمية.</p>\r\n                </div>\r\n                <div style={{ display: 'flex', gap: '0.75rem' }}>\r\n                    <button onClick={() => router.push('/dashboard/reports')} className=\"btn btn-outline\">\r\n                        <Calendar size={18} />\r\n                        <span>تقارير اليوم</span>\r\n                    </button>\r\n                    <button onClick={fetchDashboardData} className=\"btn btn-primary\" style={{ background: 'var(--primary)' }}>\r\n                        <RefreshCcwIcon size={18} />\r\n                        <span>تحديث البيانات</span>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Stats Cards */}\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: '1.5rem', marginBottom: '2rem' }}>\r\n                {cards.map((card, idx) => (\r\n                    <motion.div\r\n                        key={idx}\r\n                        initial={{ opacity: 0, y: 10 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        transition={{ delay: idx * 0.1 }}\r\n                        className=\"card\"\r\n                        style={{ display: 'flex', flexDirection: 'column', gap: '1rem', borderTop: `4px solid currentColor`, color: card.color.includes('blue') ? '#2563eb' : card.color.includes('emerald') ? '#10b981' : card.color.includes('amber') ? '#d97706' : '#4f46e5' }}\r\n                    >\r\n                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>\r\n                            <div>\r\n                                <p style={{ fontSize: '0.9rem', color: 'var(--text-secondary)', fontWeight: '600' }}>{card.title}</p>\r\n                                <h3 style={{ fontSize: '1.75rem', fontWeight: '800', color: 'var(--text-main)', marginTop: '0.25rem' }}>{card.value}</h3>\r\n                                {(card as any).subtitle && <p style={{ fontSize: '0.9rem', color: 'var(--text-secondary)', marginTop: '0.25rem' }}>{(card as any).subtitle}</p>}\r\n                            </div>\r\n                            <div style={{ padding: '0.75rem', borderRadius: '0.75rem', background: card.bg.replace('bg-', 'var(--').replace('-50', '-50)'), backgroundColor: '#f1f5f9' }}>\r\n                                <card.icon size={24} />\r\n                            </div>\r\n                        </div>\r\n                        <div style={{ fontSize: '0.85rem', display: 'flex', alignItems: 'center', gap: '0.5rem', color: 'var(--text-muted)' }}>\r\n                            <TrendingUp size={14} />\r\n                            <span>{card.trend}</span>\r\n                        </div>\r\n                    </motion.div>\r\n                ))}\r\n            </div>\r\n\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(12, 1fr)', gap: '1.5rem' }}>\r\n                {/* Recent Activity Section */}\r\n                <div className=\"card\" style={{ gridColumn: 'span 12' }}>\r\n                    <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '1.5rem' }}>\r\n                        <h3 style={{ fontWeight: '700' }}>سجل النشاطات الحديثة</h3>\r\n                        <button onClick={() => router.push('/dashboard/logs')} style={{ color: 'var(--brand)', fontSize: '0.9rem', fontWeight: '600' }}>عرض الكل</button>\r\n                    </div>\r\n\r\n                    <div className=\"table-wrapper\">\r\n                        <table>\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>النشاط</th>\r\n                                    <th>المستخدم</th>\r\n                                    <th>التوقيت</th>\r\n                                    <th>الحالة</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                {recentLogs.length === 0 ? (\r\n                                    <tr>\r\n                                        <td colSpan={4} style={{ textAlign: 'center', padding: '2rem', color: 'var(--text-muted)' }}>لا توجد بيانات حالياً</td>\r\n                                    </tr>\r\n                                ) : (\r\n                                    recentLogs.map((log) => (\r\n                                        <tr key={log.id}>\r\n                                            <td style={{ fontWeight: '600' }}>{log.action}</td>\r\n                                            <td>{log.user_id || 'System'}</td>\r\n                                            <td style={{ direction: 'ltr', textAlign: 'right' }}>\r\n                                                {new Date(log.created_at).toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit' })}\r\n                                            </td>\r\n                                            <td>\r\n                                                <span className=\"status-badge status-info\">مكتمل</span>\r\n                                            </td>\r\n                                        </tr>\r\n                                    ))\r\n                                )}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction RefreshCcwIcon({ size }: { size: number }) {\r\n    return (\r\n        <svg\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            width={size}\r\n            height={size}\r\n            viewBox=\"0 0 24 24\"\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            strokeWidth=\"2\"\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n        >\r\n            <path d=\"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8\" />\r\n            <path d=\"M3 3v5h5\" />\r\n            <path d=\"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16\" />\r\n            <path d=\"M16 16h5v5\" />\r\n        </svg>\r\n    )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}