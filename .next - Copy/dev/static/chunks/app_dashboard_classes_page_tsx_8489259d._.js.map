{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///F:/school/app/dashboard/classes/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { supabase } from '@/lib/supabase';\r\nimport { Printer, Loader2 } from 'lucide-react';\r\nimport jsPDF from 'jspdf';\r\nimport 'jspdf-autotable';\r\n\r\n// Type definition for Student\r\ntype Student = {\r\n    id: string;\r\n    full_name: string;\r\n    religion: string;\r\n    gender: string;\r\n    birth_date: string;\r\n    national_id: string; // Added for 12 D Lists\r\n};\r\n\r\nexport default function ClassesPage() {\r\n    const [grade, setGrade] = useState('الصف الأول الابتدائي');\r\n    const [classGroup, setClassGroup] = useState('');\r\n    const [students, setStudents] = useState<Student[]>([]);\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const fetchClassValidation = async () => {\r\n        if (!grade) return;\r\n        setLoading(true);\r\n        try {\r\n            // @ts-ignore\r\n            let query = supabase\r\n                .from('students')\r\n                .select('*')\r\n                .eq('grade', grade)\r\n                .eq('status', 'active')\r\n                .order('full_name');\r\n\r\n            if (classGroup) {\r\n                query = query.eq('class_group', classGroup);\r\n            }\r\n\r\n            const { data, error } = await query;\r\n            if (error) throw error;\r\n            setStudents(data as unknown as Student[] || []);\r\n        } catch (error) {\r\n            console.error(error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchClassValidation();\r\n    }, [grade, classGroup]);\r\n\r\n    // Function to generate \"12 D\" style list (Government Standard)\r\n    const printClassList = () => {\r\n        const doc = new jsPDF({ orientation: 'p', unit: 'mm', format: 'a4' });\r\n\r\n        // Setup Arabic Font (Simulated for this environment, normally requires addFont)\r\n        doc.setLanguage('ar');\r\n\r\n        // Header\r\n        doc.setFontSize(16);\r\n        doc.text('قوائم الفصول - نموذج 41 مستجد', 105, 15, { align: 'center' });\r\n        doc.setFontSize(12);\r\n        doc.text(`الصف: ${grade}`, 190, 25, { align: 'right' });\r\n        doc.text(`الفصل: ${classGroup || 'الكل'}`, 190, 32, { align: 'right' });\r\n        doc.text(`العام الدراسي: 2025 / 2026`, 20, 25, { align: 'left' });\r\n\r\n        // Table\r\n        const tableColumn = [\"م\", \"الاسم\", \"الديانة\", \"النوع\", \"تاريخ الميلاد\", \"ملاحظات\"];\r\n        const tableRows: (string | number)[][] = [];\r\n\r\n        students.forEach((student, index) => {\r\n            const studentData = [\r\n                index + 1,\r\n                student.full_name,\r\n                student.religion === 'muslim' ? 'مسلم' : 'مسيحي',\r\n                student.gender === 'male' ? 'ذكر' : 'أنثى',\r\n                student.birth_date,\r\n                '',\r\n            ];\r\n            tableRows.push(studentData);\r\n        });\r\n\r\n        // @ts-ignore\r\n        doc.autoTable({\r\n            head: [tableColumn],\r\n            body: tableRows,\r\n            startY: 40,\r\n            styles: { font: 'Cairo', halign: 'right' },\r\n            headStyles: { fillColor: [15, 23, 42] },\r\n            theme: 'grid'\r\n        });\r\n\r\n        doc.save(`class_list_${grade}.pdf`);\r\n    };\r\n\r\n    return (\r\n        <div style={{ maxWidth: '1200px', margin: '0 auto' }}>\r\n            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '2rem' }}>\r\n                <div>\r\n                    <h1 style={{ fontSize: '1.5rem', fontWeight: 'bold' }}>قوائم الفصول</h1>\r\n                    <p className=\"text-muted\">عرض وطباعة قوائم الفصول (12 د / 41 مستجد)</p>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"card\" style={{ marginBottom: '1.5rem', display: 'flex', gap: '1.5rem', flexWrap: 'wrap', alignItems: 'flex-end' }}>\r\n                <div style={{ flex: 1, minWidth: '200px' }}>\r\n                    <label className=\"label\">الصف الدراسي</label>\r\n                    <select value={grade} onChange={(e) => setGrade(e.target.value)} className=\"input-field\">\r\n                        <optgroup label=\"المرحلة الابتدائية\">\r\n                            <option value=\"الصف الأول الابتدائي\">الصف الأول الابتدائي</option>\r\n                            <option value=\"الصف الثاني الابتدائي\">الصف الثاني الابتدائي</option>\r\n                            <option value=\"الصف الثالث الابتدائي\">الصف الثالث الابتدائي</option>\r\n                            <option value=\"الصف الرابع الابتدائي\">الصف الرابع الابتدائي</option>\r\n                            <option value=\"الصف الخامس الابتدائي\">الصف الخامس الابتدائي</option>\r\n                            <option value=\"الصف السادس الابتدائي\">الصف السادس الابتدائي</option>\r\n                        </optgroup>\r\n                        <optgroup label=\"المرحلة الإعدادية\">\r\n                            <option value=\"الصف الأول الإعدادي\">الصف الأول الإعدادي</option>\r\n                            <option value=\"الصف الثاني الإعدادي\">الصف الثاني الإعدادي</option>\r\n                            <option value=\"الصف الثالث الإعدادي\">الصف الثالث الإعدادي</option>\r\n                        </optgroup>\r\n                    </select>\r\n                </div>\r\n                <div style={{ flex: 1, minWidth: '200px' }}>\r\n                    <label className=\"label\">الفصل (اختياري)</label>\r\n                    <input\r\n                        value={classGroup}\r\n                        onChange={(e) => setClassGroup(e.target.value)}\r\n                        className=\"input-field\"\r\n                        placeholder=\"مثال: 1/1\"\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <button onClick={printClassList} className=\"btn btn-primary\" disabled={students.length === 0}>\r\n                        <Printer size={18} />\r\n                        <span>طباعة القائمة</span>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"card\" style={{ padding: 0, minHeight: '400px' }}>\r\n                <div className=\"table-wrapper\" style={{ border: 'none', borderRadius: '0' }}>\r\n                    <table className=\"data-table\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th style={{ width: '50px' }}>#</th>\r\n                                <th>اسم الطالب</th>\r\n                                <th>الديانة</th>\r\n                                <th>النوع</th>\r\n                                <th>تاريخ الميلاد</th>\r\n                                <th>العنوان</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {loading ? (\r\n                                <tr><td colSpan={6} style={{ textAlign: 'center', padding: '3rem' }}><Loader2 className=\"animate-spin\" /></td></tr>\r\n                            ) : students.length === 0 ? (\r\n                                <tr><td colSpan={6} style={{ textAlign: 'center', padding: '3rem' }} className=\"text-muted\">لا يوجد طلاب في هذا الفصل</td></tr>\r\n                            ) : (\r\n                                students.map((s, i) => (\r\n                                    <tr key={s.id}>\r\n                                        <td>{i + 1}</td>\r\n                                        <td style={{ fontWeight: 600 }}>{s.full_name}</td>\r\n                                        <td>{s.religion === 'muslim' ? 'مسلم' : 'مسيحي'}</td>\r\n                                        <td>{s.gender === 'male' ? 'ذكر' : 'أنثى'}</td>\r\n                                        <td>{s.birth_date}</td>\r\n                                        <td>-</td>\r\n                                    </tr>\r\n                                ))\r\n                            )}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}